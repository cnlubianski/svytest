% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/permutation.R
\name{.wls_fit}
\alias{.wls_fit}
\title{Internal helper: Weighted least squares fit}
\usage{
.wls_fit(X, y, w)
}
\arguments{
\item{X}{Numeric design matrix.}

\item{y}{Numeric response vector.}

\item{w}{Numeric vector of weights.}
}
\value{
A list with elements \code{beta}, \code{mu}, \code{resid},
  \code{sigma2}, and \code{XtX}.
}
\description{
Performs a weighted least squares regression using QR decomposition,
with a generalized inverse fallback if the system is singular.
}
\keyword{internal}
